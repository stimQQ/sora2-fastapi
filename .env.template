# ===================================
# Video Animation Platform - Environment Configuration
# ===================================
# IMPORTANT: Copy this file to .env and fill in your actual values
# Command: cp .env.template .env

# ===================================
# Core Application Settings
# ===================================
APP_NAME="Video Animation Platform"
APP_VERSION="1.0.0"
ENVIRONMENT="development"  # development | staging | production
DEBUG=True
SECRET_KEY="change-this-to-a-random-32-character-string"
PROXY_API_KEY="your-internal-api-key-here"

# Server
HOST="0.0.0.0"
PORT=8000
WORKERS=4

# API URLs
API_BASE_URL="http://localhost:8000"
FRONTEND_URL="http://localhost:3000"

# ===================================
# Database Configuration (PostgreSQL)
# ===================================
# Master database (write operations)
DATABASE_URL_MASTER="postgresql+asyncpg://postgres:password@localhost:5432/video_animation_db"

# Slave databases (read operations) - comma-separated for load balancing
# Leave empty to use master for both read and write
DATABASE_URL_SLAVES=""

# Connection pool settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40
DATABASE_POOL_TIMEOUT=30
DATABASE_ECHO=False  # Set to True for SQL query debugging

# ===================================
# Redis Configuration
# ===================================
REDIS_URL="redis://localhost:6379/0"
REDIS_PASSWORD=""  # Optional password
REDIS_POOL_SIZE=10

# Celery (async task queue)
CELERY_BROKER_URL="redis://localhost:6379/1"
CELERY_RESULT_BACKEND="redis://localhost:6379/2"
CELERY_TIMEZONE="Asia/Shanghai"

# ===================================
# Storage Configuration
# ===================================
STORAGE_BACKEND="oss"  # oss | s3 | local

# Aliyun OSS (Object Storage Service)
ALIYUN_OSS_ACCESS_KEY="your-oss-access-key-id"
ALIYUN_OSS_SECRET_KEY="your-oss-secret-access-key"
ALIYUN_OSS_BUCKET="your-bucket-name"
ALIYUN_OSS_ENDPOINT="https://oss-cn-beijing.aliyuncs.com"
ALIYUN_OSS_REGION="cn-beijing"
ALIYUN_OSS_CDN_DOMAIN=""  # Optional: CDN domain for acceleration

# AWS S3 (Alternative)
AWS_ACCESS_KEY_ID=""
AWS_SECRET_ACCESS_KEY=""
AWS_S3_BUCKET=""
AWS_S3_REGION="ap-southeast-1"
AWS_S3_ENDPOINT_URL=""

# Local Storage (for development)
LOCAL_STORAGE_PATH="./uploads"

# ===================================
# AI Video Generation APIs
# ===================================
# DashScope (Wan2.2-Animate)
QWEN_VIDEO_API_KEY="your-dashscope-api-key"
DASHSCOPE_API_URL="https://dashscope.aliyuncs.com/api/v1"
DASHSCOPE_TIMEOUT=30

# Sora 2 (Kie.ai)
SORA_API_KEY="your-sora-api-key"
SORA_API_URL="https://api.kie.ai/api/v1"
SORA_TIMEOUT=30
SORA_CALLBACK_URL="https://your-domain.com/api/videos/sora/callback"

# ===================================
# Authentication Providers
# ===================================
AUTH_PROVIDERS_ENABLED="wechat,google"

# SMS (Aliyun)
ALIYUN_SMS_ACCESS_KEY="your-sms-access-key"
ALIYUN_SMS_SECRET_KEY="your-sms-secret-key"
ALIYUN_SMS_SIGN_NAME="your-sign-name"
ALIYUN_SMS_TEMPLATE_CODE="SMS_xxxxxxxxxxxxx"

# Google OAuth
GOOGLE_CLIENT_ID="your-google-client-id.apps.googleusercontent.com"
GOOGLE_CLIENT_SECRET="your-google-client-secret"
GOOGLE_REDIRECT_URI="http://localhost:8000/api/auth/google/callback"

# WeChat OAuth (for China users)
WECHAT_APP_ID="your-wechat-app-id"
WECHAT_APP_SECRET="your-wechat-app-secret"
WECHAT_REDIRECT_URI="https://your-domain.com/api/auth/wechat/callback"

# JWT Token Settings
JWT_ALGORITHM="HS256"
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=1440  # 24 hours
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30

# ===================================
# Payment Providers
# ===================================
PAYMENT_PROVIDERS_ENABLED="wechat_pay,stripe"

# Stripe
STRIPE_SECRET_KEY="sk_test_xxxxxxxxxxxxx"
STRIPE_PUBLISHABLE_KEY="pk_test_xxxxxxxxxxxxx"
STRIPE_WEBHOOK_SECRET="whsec_xxxxxxxxxxxxx"

# WeChat Pay (for China users)
WECHAT_PAY_APP_ID=""
WECHAT_PAY_MERCHANT_ID=""
WECHAT_PAY_API_KEY=""
WECHAT_PAY_CERT_PATH=""
WECHAT_PAY_NOTIFY_URL=""

# ===================================
# Security & CORS
# ===================================
CORS_ALLOWED_ORIGINS="http://localhost:3000,https://your-domain.com"

# Rate Limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_DEFAULT="100/minute"

# ===================================
# File Upload Settings
# ===================================
MAX_UPLOAD_SIZE=104857600  # 100MB in bytes

# Allowed file extensions (JSON array format)
# ALLOWED_IMAGE_EXTENSIONS='[".jpg",".jpeg",".png",".webp"]'
# ALLOWED_VIDEO_EXTENSIONS='[".mp4",".mov",".avi",".webm"]'

# ===================================
# Task Processing
# ===================================
TASK_TIMEOUT=600  # 10 minutes
TASK_MAX_RETRIES=3
TASK_RETRY_DELAY=60  # 1 minute
TASK_RESULT_EXPIRY=86400  # 24 hours

# ===================================
# Credits System
# ===================================
DEFAULT_USER_CREDITS=100  # Initial credits for new users

# Video generation pricing (per second)
CREDITS_PER_SECOND_STANDARD=10  # Wan2.2 standard mode
CREDITS_PER_SECOND_PRO=14  # Wan2.2 pro mode

# Sora 2 pricing (per video, fixed cost)
CREDITS_SORA_TEXT_TO_VIDEO_STANDARD=20
CREDITS_SORA_TEXT_TO_VIDEO_HD=30
CREDITS_SORA_IMAGE_TO_VIDEO_STANDARD=25
CREDITS_SORA_IMAGE_TO_VIDEO_HD=35

# Credit value
CREDIT_VALUE_RMB=0.1  # 1 credit = Â¥0.1 RMB

# Credit expiry
CREDIT_EXPIRY_MONTHS=6  # Credits expire after 6 months

# ===================================
# Monitoring & Logging
# ===================================
LOG_LEVEL="INFO"  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_FORMAT="json"
LOG_FILE_PATH="./logs/app.log"
LOG_ROTATION="1 day"
LOG_RETENTION="30 days"

# Prometheus
PROMETHEUS_ENABLED=True
PROMETHEUS_PORT=9090

# Sentry (error tracking)
SENTRY_DSN=""

# ===================================
# Region Detection
# ===================================
GEOIP_DATABASE_PATH="./data/GeoLite2-City.mmdb"
DEFAULT_REGION="CN"
SUPPORTED_REGIONS="CN,US,EU,ASIA"

# ===================================
# Email Notifications (Optional)
# ===================================
SMTP_HOST=""
SMTP_PORT=587
SMTP_USER=""
SMTP_PASSWORD=""
SMTP_FROM_EMAIL=""

# ===================================
# Development/Testing
# ===================================
# Set to "1" when running on Vercel (enables serverless optimizations)
VERCEL="0"
